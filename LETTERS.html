<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <meta name="viewport"
    content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui">
  <meta name="referrer" content="no-referrer">
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="keywords" content="猫猫の生活 马里奥，嗷呜">
  <meta name="description" content="马里奥嗷呜的小生活~">
  <title>FUTURE</title>
  <link rel="shortcut icon" href="./public/img/shortcut.jpg">
  <link rel="stylesheet" href="./public/css/account.css">
  <link rel="stylesheet" href="./public/css/navbar.css">
  <link rel="stylesheet" href="./public/css/main.css">



  <style>
    #cloud {
      width: 100%;
      height: 400px;
      border-bottom: 1px solid #ddd;
    }
  </style>



  <script src="./public/js/hm.js.下载"></script>
  <script>
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cc68c054b58c800c1687d2925e5b40ff";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>

</head>

<body>


  <div class="nav-container white">

    <div class="menu-wrap">
      <h1 class="home"><a href="./index.html">M&amp;A</a></h1>
      <div id="open" class="sub-nav-btn open">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>

    <div id="nav" class="nav-wrap">
      <div class="main-nav">
        <ul class="nav">
          <li><a href="./index.html">
              <span class="en">HOME</span>
              <span class="ch">首页</span>
              <small>「首页」</small></a></li>
          <li><a href="./PROFILE.html">
              <span class="en">PROFILE</span>
              <span class="ch">它们</span>
              <div class="line"></div>
              <small>「它们」</small>
            </a></li>
          <li><a href="./RECORD.html">
              <span class="en">RECORD</span>
              <span class="ch">成长记录</span>
              <div class="line"></div>
              <small>「成长记录」</small>
            </a></li>
          <li><a href="./HELP.html">
              <span class="en">HELP</span>
              <span class="ch">资助</span>
              <div class="line"></div>
              <small>「资助」</small>
            </a></li>
          <li><a href="./RELATION.html">
              <span class="en">RELATION</span>
              <span class="ch">关系</span>
              <div class="line"></div>
              <small>「关系」</small>
            </a></li>
          <li><a href="./future.html">
              <span class="en">FUTURE</span>
              <span class="ch">未来</span>
              <div class="line"></div>
              <small>「未来」</small>
            </a></li>
        </ul>
      </div>

      <div class="sub-nav">
        <div id="close" class="sub-nav-btn close">
          <span></span>
          <span></span>
        </div>
        <ul class="nav">
          <li><a href="./LOGIN.html">Login</a></li>
        </ul>
      </div>

      <div class="footer-nav">
        <ul class="nav">
          <li><a href="./FAQ.html">FAQ</a></li>
          <li><a href="./ABOUT.html">关于本站</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="main-container">

    <div class="visualbg-cover" style="background-image: url(&#39;./public/img/FUTURE.jpg&#39;)">
      <div class="contain">
        <div class="scroll_circle"></div>
      </div>
    </div>

    <div id="letters" class="container">
      <div class="subpage-wrap letters-wrap">
        <h2 class="title center">已发&nbsp;<span id="lettersCount" class="count"></span>&nbsp;封信</h2>
        <ul id="lettersBox" class="list"></ul>
        <div id="loadMoreHidden"></div>
        <div id="loadMore"></div>
        <div class="text-wrap">
          <a href="https://www.bjyxszd.com/letter/add"><i class="edit"></i>写信（需审核，2026年会公开）</a>
        </div>
      </div>
    </div>

    <div class="tree-menu-wrap letter-menu">
      <ul>
        <li><a class="type edit" href="https://www.bjyxszd.com/letter/add" title="写信（需审核，2026年会公开）"></a></li>
        <li><a class="type top" href="https://www.bjyxszd.com/future#TopHere" title="回顶部"></a></li>
      </ul>
    </div>
  </div>

  <footer class="">
    <div class="container">
      <p class="links">
        <a href="https://www.bjyxszd.com/about">关于本站</a> <span>|</span>
        <a href="https://www.bjyxszd.com/mdzs">魔道祖师</a> <span>|</span>
        <a href="https://www.bjyxszd.com/faq">FAQ</a> <span>|</span>
        <a href="https://www.bjyxszd.com/links">友情链接</a>
      </p>
      <p class="meta">Copyright 2019 BJYX. All rights reserved.</p>
      <p class="beian">
        <a href="http://www.beian.miit.gov.cn/" target="_blank">晋ICP备17006703号</a> <span>|</span>
        <img src="./FUTURE_files/备案图标.png" alt="备案"><a href="http://www.beian.gov.cn/portal/index.do"
          target="_blank">晋公网安备 14010702070546号</a>
      </p>
    </div>
  </footer>

  <script src="./FUTURE_files/jquery.min.js.下载"></script>

  <script src="./FUTURE_files/main.js.下载"></script>
  <script src="./FUTURE_files/handlebars.min.js.下载"></script>
  <script src="./FUTURE_files/d3.min.js.下载"></script>
  <script src="./FUTURE_files/d3.layout.cloud.js.下载"></script>

  <script id="lettersSumTemplate" type="text/x-handlebars-template">
  {{count}}
</script>

  <script id="lettersTemplate" type="text/x-handlebars-template">

    {{#each letters}}
    <li class="item">
      {{#if this.avatarUrl}}
      <div class="img" style="background-image: url({{this.avatarUrl}})"></div>
      {{else}}
      <div class="img" style="background-image: url('/public/img/ggdd/avatar_def.jpg')"></div>
      {{/if}}
      <div class="time-wrap">
        <div class="time time1">{{this.createDate}}</div>
        <div class="time time2">{{this.createDate}}</div>
      </div>
      <div class="meta">
        <p class="t">{{this.username}}</p>
        <p class="c" title="{{{this.title}}}">{{{this.title}}}</p>
      </div>
    </li>
    {{/each}}
  
</script>

  <script id="loadMoreHiddenTemplate" type="text/x-handlebars-template">
  <input id="hiddenPage" type="hidden" name="page" value="{{page}}">
  <input id="hiddenPages" type="hidden" name="pages" value="{{pages}}">
  <input id="hiddenType" type="hidden" name="count" value="{{count}}">
</script>


  <script>


    $(function () {

      // 请求信件数据并加载
      var bInitLetters = false;
      var lettersTemplate = Handlebars.compile($("#lettersTemplate").html());
      var lettersSumTemplate = Handlebars.compile($("#lettersSumTemplate").html());
      var loadMoreHiddenTemplate = Handlebars.compile($("#loadMoreHiddenTemplate").html());
      var $lettersBox = $('#lettersBox');
      var $lettersCount = $('#lettersCount');
      var $loadMoreHidden = $('#loadMoreHidden');
      var $loadMore = $('#loadMore');
      var iLetterTop = $('#letters').offset().top;

      function formatLetters(data) {

        return data.map(function (letter) {
          return {
            username: letter.username,
            avatarUrl: letter.avatarUrl,
            title: letter.title,
            createDate: letter.createDate
          };
        })
      }

      function renderLoadMore(page, pages) {
        page = Number.parseInt(page);
        pages = Number.parseInt(pages);
        if (page < pages) {
          $loadMore.html('<a id="loadMoreBtn" href="#">MORE</a>');
        } else {
          $loadMore.html('');
        }
      }

      function loadLetters(page) {
        $.ajax('/letters?page=' + page, {
          success: function (data) {
            if (data.letters && data.letters.length > 0) {
              data.letters = formatLetters(data.letters);
              $lettersCount.html(lettersSumTemplate(data));
              $lettersBox.html($lettersBox.html() + lettersTemplate(data));
              $loadMoreHidden.html(loadMoreHiddenTemplate(data));
              renderLoadMore(data.page, data.pages);
            }
          }
        })
      }

      function bindEvent() {

        // 加载更多
        $loadMore.on('click', '#loadMoreBtn', function (evt) {

          evt.preventDefault();
          var page = Number.parseInt($('#hiddenPage').val());
          loadLetters(page + 1);
        })
      }


      $(window).scroll(function () {

        if (bInitLetters) return;
        var iViewTop = iLetterTop - $(window).scrollTop();
        if (!bInitLetters && iViewTop < $(window).height()) {
          bInitLetters = true;
          loadLetters(1);
          bindEvent();
        }
      })

      // 词云
      var fill = d3.scaleOrdinal(d3.schemeCategory10)
      var layout = d3.layout.cloud()
        .size([1082, 400])
        .words([
          '王一博', '一博', '王老师', '老王', '博弟', '王甜甜', '蓝湛', '蓝忘机', '含光君', '蓝二公子', '蓝二哥哥', '机兄', '美妆博主',
          '肖战', '肖战啊', '肖老师', '老肖', '战哥', '战狼', '赞哥', '夷陵老祖', '魏无羡', '魏婴', '魏公子', '魏哥哥', '魏兄', '小赞']
          .map(function (d) {
            return { text: d, size: 10 + Math.random() * 40, test: "haha" };
          }))
        .padding(5)
        .rotate(function () { return ~~(Math.random() * 2) * 90; })
        .font("Impact")
        .fontSize(function (d) { return d.size; })
        .on("end", draw);


      layout.start();

      function draw(words) {
        d3.select("#cloud").append("svg")
          .attr("width", layout.size()[0])
          .attr("height", layout.size()[1])
          .append("g")
          .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
          .selectAll("text")
          .data(words)
          .enter().append("text")
          .style("font-size", function (d) { return d.size + "px"; })
          .style("font-family", "Impact")
          .style("fill", function (d, i) { return fill(i); })
          .attr("text-anchor", "middle")
          .attr("transform", function (d) {
            return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
          })
          .text(function (d) { return d.text; });
      }
    })

  </script>



</body>

</html>